<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Script Writer â€” Wildlife Scriptment Engine</title>
  <meta name="description"
    content="A multi-agent AI system for developing blue-chip natural history film scriptments." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
    rel="stylesheet" />
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ¬</text></svg>" />
  <link rel="stylesheet" href="/src/styles.css" />
</head>

<body>

  <!-- â•â•â•â•â•â•â• Top Nav Bar â•â•â•â•â•â•â• -->
  <nav id="top-nav" class="top-nav">
    <div class="nav-brand">ğŸ¬ <span>ScriptWriter</span></div>
    <div class="nav-actions">
      <button id="btn-advanced" class="nav-btn" title="Advanced Settings">
        âš™ï¸ <span class="nav-btn-label">Advanced</span>
      </button>
      <button id="btn-knowledge" class="nav-btn" title="Knowledge Base">
        ğŸ“š <span class="nav-btn-label">Knowledge</span>
        <span id="kb-badge" class="nav-badge hidden">0</span>
      </button>
      <button id="btn-history" class="nav-btn" title="Run History">
        ğŸ•“ <span class="nav-btn-label">History</span>
        <span id="history-badge" class="nav-badge hidden">0</span>
      </button>
    </div>
  </nav>

  <!-- â•â•â•â•â•â•â• Knowledge Panel (Right Slide) â•â•â•â•â•â•â• -->
  <aside id="knowledge-panel" class="side-panel hidden">
    <div class="panel-header">
      <h3>ğŸ“š Knowledge Base</h3>
      <button class="panel-close" data-close="knowledge-panel">âœ•</button>
    </div>
    <div class="panel-body">

      <!-- â”€â”€â”€ Shared KB Section â”€â”€â”€ -->
      <div class="kb-section">
        <div class="kb-section-header">
          <span class="kb-section-icon">ğŸŒ</span>
          <span class="kb-section-title">Shared Knowledge Base</span>
          <span class="kb-section-hint">All users</span>
        </div>
        <p class="panel-description">Documents here are available to everyone using this tool.</p>

        <!-- Admin unlock -->
        <div id="kb-admin-unlock" class="kb-admin-unlock">
          <input type="password" id="kb-admin-password" class="kb-admin-input" placeholder="Admin password to uploadâ€¦"
            autocomplete="off" />
          <button id="kb-admin-unlock-btn" class="kb-admin-unlock-btn">Unlock</button>
        </div>

        <!-- Admin upload zone (hidden until unlocked) -->
        <div id="kb-shared-upload-area" class="hidden">
          <div id="shared-upload-zone" class="upload-zone upload-zone-shared">
            <input type="file" id="shared-file-input" accept=".txt,.md,.text,.markdown,.pdf" multiple hidden />
            <div class="upload-zone-content">
              <span class="upload-icon">â¬†</span>
              <span>Drop files or <button id="shared-browse-btn" class="link-btn">browse</button></span>
            </div>
          </div>
          <div class="url-input-row">
            <input type="text" id="shared-url-input" class="url-input" placeholder="Paste a URL to add to shared KBâ€¦" />
            <button id="shared-url-add-btn" class="url-add-btn">ğŸ”— Add</button>
          </div>
          <div id="shared-upload-progress" class="upload-progress hidden">
            <div class="progress-bar">
              <div id="shared-progress-fill" class="progress-fill"></div>
            </div>
            <span id="shared-progress-text" class="progress-text">Uploadingâ€¦</span>
          </div>

          <!-- Intelligence Refresh -->
          <div class="intel-refresh-section">
            <div class="intel-refresh-header">
              <span class="intel-refresh-title">ğŸ”„ Industry Intelligence</span>
              <span id="intel-last-refreshed" class="intel-last-refreshed">Never refreshed</span>
            </div>
            <p class="intel-refresh-desc">Fetches 8 curated industry sources (Realscreen, C21Media, Wildscreen, Jackson
              Wild, Broadcast Now, Televisual, Trends in Ecology, Think with Google) and indexes them into the shared
              KB.</p>
            <button id="intel-refresh-btn" class="intel-refresh-btn">
              <span class="intel-refresh-btn-icon">ğŸ”„</span>
              <span id="intel-refresh-btn-text">Refresh Industry Intelligence</span>
            </button>
            <div id="intel-refresh-log" class="intel-refresh-log hidden"></div>
          </div>
        </div>


        <div id="shared-doc-list" class="doc-list">
          <p class="panel-empty">Loading shared documentsâ€¦</p>
        </div>
      </div>

      <hr class="kb-divider" />

      <!-- â”€â”€â”€ Personal KB Section â”€â”€â”€ -->
      <div class="kb-section">
        <div class="kb-section-header">
          <span class="kb-section-icon">ğŸ’»</span>
          <span class="kb-section-title">Your Documents</span>
          <span class="kb-section-hint">This browser only</span>
        </div>
        <p class="panel-description">Upload documents (.txt, .md, .pdf) or add web links. Only visible to you.</p>
        <div id="upload-zone" class="upload-zone">
          <input type="file" id="file-input" accept=".txt,.md,.text,.markdown,.pdf" multiple hidden />
          <div class="upload-zone-content">
            <span class="upload-icon">â¬†</span>
            <span>Drop files here or <button id="browse-btn" class="link-btn">browse</button></span>
          </div>
        </div>
        <div class="url-input-row">
          <input type="text" id="url-input" class="url-input" placeholder="Paste a URL to add as knowledgeâ€¦" />
          <button id="url-add-btn" class="url-add-btn">ğŸ”— Add</button>
        </div>
        <div id="upload-progress" class="upload-progress hidden">
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <span id="progress-text" class="progress-text">Embedding...</span>
        </div>
        <div id="doc-list" class="doc-list"></div>
      </div>

    </div>
  </aside>


  <!-- â•â•â•â•â•â•â• History Panel (Right Slide) â•â•â•â•â•â•â• -->
  <aside id="history-panel" class="side-panel hidden">
    <div class="panel-header">
      <h3>ğŸ•“ Run History</h3>
      <button class="panel-close" data-close="history-panel">âœ•</button>
    </div>
    <div class="panel-body">
      <div id="history-list" class="history-list"></div>
      <p id="history-empty" class="panel-empty">No runs yet. Launch a simulation to see results here.</p>
    </div>
  </aside>

  <!-- â•â•â•â•â•â•â• Panel Overlay â•â•â•â•â•â•â• -->
  <div id="panel-overlay" class="panel-overlay hidden"></div>

  <!-- â•â•â•â•â•â•â• Hero Section â•â•â•â•â•â•â• -->
  <header id="hero">
    <div class="hero-bg"></div>
    <div class="hero-content">
      <div class="hero-badge">Multi-Agent AI System</div>
      <h1><span class="title-accent">Script</span>Writer</h1>
      <p class="hero-subtitle">Blue-Chip Wildlife Scriptment Engine</p>
      <p class="hero-description">
        Enter a seed idea. Eight AI agents will debate, reject, revise, and greenlight your wildlife film pitch
        â€” in <strong>3 different genre lenses</strong> automatically.
      </p>

      <form id="seed-form">
        <div class="input-group">
          <textarea id="seed-input"
            placeholder="Describe your wildlife documentary ideaâ€¦&#10;e.g., Octopus intelligence and tool use in Indonesian coral reefs"
            rows="3" required></textarea>

          <!-- â•â•â• Advanced Options (collapsed by default) â•â•â• -->
          <div id="advanced-options" class="advanced-options collapsed">
            <button type="button" id="advanced-toggle" class="advanced-toggle">
              <span class="toggle-icon">â–¸</span> Advanced Options
            </button>
            <div class="advanced-options-body">
              <!-- Mode Toggle -->
              <div class="mode-toggle">
                <button type="button" class="mode-tab active" data-mode="seed">ğŸŒ± Seed Idea</button>
                <button type="button" class="mode-tab" data-mode="script">ğŸ“ Assess Script</button>
              </div>

              <div class="optional-params">
                <div class="param-field">
                  <label for="target-platform">ğŸ“º Platform <span class="param-hint">(optional)</span></label>
                  <select id="target-platform">
                    <option value="">Auto-detect best fit</option>
                    <option value="Netflix">Netflix</option>
                    <option value="Apple TV+">Apple TV+</option>
                    <option value="BBC Studios">BBC Studios</option>
                    <option value="Disney+">Disney+ / National Geographic</option>
                    <option value="Amazon Prime">Amazon Prime</option>
                    <option value="ZDF / ARTE">ZDF / ARTE</option>
                    <option value="Channel 4">Channel 4</option>
                    <option value="Smithsonian Channel">Smithsonian Channel</option>
                    <option value="PBS">PBS</option>
                  </select>
                </div>
                <div class="param-field">
                  <label for="production-year">ğŸ“… Delivery Year <span class="param-hint">(optional)</span></label>
                  <input type="number" id="production-year" min="2020" max="2035" placeholder="e.g., 2028">
                </div>
                <div class="param-field">
                  <label for="genre-preference">ğŸ­ Genre Lens <span class="param-hint">(locks to 1 genre)</span></label>
                  <select id="genre-preference">
                    <option value="">Auto â€” Hands-Free (3 genres)</option>
                    <option value="scientific-procedural"
                      title="ROI: Highest. The CSI of ecology â€” eDNA, satellite tagging, AI forensics. Tech partnerships + research grants.">
                      ğŸ”¬ Scientific Procedural</option>
                    <option value="nature-noir"
                      title="ROI: High. True Crime for the planet â€” environmental crimes via forensic filmmaking. Legal/Gov funding + SVOD.">
                      ğŸ•µï¸ Nature Noir</option>
                    <option value="speculative-nh"
                      title="ROI: High. AI-generated future-casts of ecosystems under climate stress. Education licensing + VR/XR.">
                      ğŸŒ Speculative NH</option>
                    <option value="urban-rewilding"
                      title="ROI: Mid-High. Wildlife adapting to industrial/urban ruins. Youth-first AVOD + local gov sponsorship.">
                      ğŸ™ï¸ Urban Rewilding</option>
                    <option value="biocultural-history"
                      title="ROI: Moderate. Prestige essays on deep time human-nature connection. Global streamers + heritage grants.">
                      ğŸ“œ Biocultural History</option>
                    <option value="blue-chip-2"
                      title="ROI: Moderate. Ultra-scarcity verified-real captures of rare behaviors. High-ticket one-off licenses.">
                      ğŸ’ Blue Chip 2.0</option>
                    <option value="indigenous-wisdom"
                      title="ROI: Moderate. Co-created narratives with TEK (Traditional Ecological Knowledge). ESG + philanthropic grants.">
                      ğŸŒ¿ Indigenous Wisdom</option>
                    <option value="ecological-biography"
                      title="ROI: Low-Mid. Decades-long deep-time tracking of single organisms via autonomous units. Museum + science licensing.">
                      ğŸŒ³ Ecological Biography</option>
                    <option value="extreme-micro"
                      title="ROI: Low-Mid. Alien visuals via nano-tech and electron microscopy. Short-form social + biotech partnerships.">
                      ğŸ”­ Extreme Micro</option>
                    <option value="astro-ecology"
                      title="ROI: Low. The orbital view â€” satellites showing global system cycles. UN/EU + space agency subsidies.">
                      ğŸ›°ï¸ Astro-Ecology</option>
                    <option value="process-doc"
                      title="ROI: Ancillary. Meta-commentary on shoot ethics and difficulty. Bundled proof-of-work for verification.">
                      ğŸ¬ The Process Doc</option>
                    <option value="symbiotic-pov"
                      title="ROI: Speculative. Extreme immersion via on-animal cameras and bio-logging. Niche VR + ethology research.">
                      ğŸ¾ Symbiotic POV</option>
                    <option value="custom">âœï¸ Customâ€¦</option>
                  </select>
                  <input type="text" id="genre-custom" class="genre-custom-input hidden"
                    placeholder="e.g., sci-fi nat-history noir">
                </div>
                <div class="param-field param-field-full">
                  <label>ğŸ”¥ Creative Mode</label>
                  <div class="chaos-mode-toggle" id="chaos-mode-toggle">
                    <button type="button" class="chaos-mode-btn" data-chaos="precision"
                      title="Standard structured pipeline â€” no surprises">
                      <span class="chaos-mode-icon">ğŸ¯</span> Precision
                    </button>
                    <button type="button" class="chaos-mode-btn active" data-chaos="exploration"
                      title="1 agent mutation + The Provocateur + a creative accident">
                      <span class="chaos-mode-icon">ğŸ”®</span> Exploration
                    </button>
                    <button type="button" class="chaos-mode-btn" data-chaos="chaos"
                      title="2 agent mutations + The Provocateur + creative accidents â€” maximum productive friction">
                      <span class="chaos-mode-icon">ğŸ”¥</span> Chaos
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <button type="submit" class="btn-primary btn-launch" id="launch-btn">
            <span class="btn-text">ğŸš€ Launch Hands-Free</span>
            <span class="btn-icon">â†’</span>
          </button>
        </div>
      </form>

      <!-- â•â•â• Genre Strategy Card (shown during hands-free mode) â•â•â• -->
      <div id="genre-strategy-card" class="genre-strategy-card hidden">
        <div class="genre-strategy-header">
          <span class="genre-strategy-icon">ğŸ¯</span>
          <span>Suggested Market Pivot Lenses</span>
        </div>
        <div id="genre-strategy-body" class="genre-strategy-body"></div>
      </div>

      <div class="agent-roster">
        <div class="agent-chip" style="--agent-color: #69db7c" data-agent-id="discovery-scout">ğŸ”¬ Scout</div>
        <div class="agent-chip" style="--agent-color: #00d4aa" data-agent-id="market-analyst">ğŸ“Š Analyst</div>
        <div class="agent-chip" style="--agent-color: #4dabf7" data-agent-id="chief-scientist">ğŸ”¬ Scientist</div>
        <div class="agent-chip" style="--agent-color: #ffa94d" data-agent-id="field-producer">ğŸ¥ Field Producer</div>
        <div class="agent-chip" style="--agent-color: #da77f2" data-agent-id="story-producer">âœï¸ Story Producer</div>
        <div class="agent-chip" style="--agent-color: #ff4444" data-agent-id="provocateur">ğŸ”¥ Provocateur</div>
        <div class="agent-chip" style="--agent-color: #ff6b6b" data-agent-id="commissioning-editor">âš”ï¸ Commissioning
          Editor</div>
        <div class="agent-chip" style="--agent-color: #ffd43b" data-agent-id="showrunner">ğŸ¬ Showrunner</div>
        <div class="agent-chip" style="--agent-color: #e03131" data-agent-id="adversary">ğŸ›¡ï¸ Gatekeeper</div>
      </div>
    </div>
  </header>

  <!-- â•â•â•â•â•â•â• Simulation Viewport â•â•â•â•â•â•â• -->
  <main id="simulation" class="hidden">
    <div class="simulation-header">
      <h2>Mission Control <span
          style="font-size:0.45em;opacity:0.5;font-weight:400;vertical-align:middle;margin-left:8px">v4 â€” Writer's Room
          Patched</span></h2>
      <div id="phase-indicator" class="phase-indicator">
        <span class="phase-dot" data-phase="1">1</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="2">2</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="3">3</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="4">4</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="5">5</span>
      </div>
    </div>
    <div class="simulation-body">
      <div id="timeline" class="timeline"></div>
    </div>
  </main>

  <!-- â•â•â•â•â•â•â• Genre Result Cards â•â•â•â•â•â•â• -->
  <section id="genre-results-grid" class="genre-results-grid hidden">
    <div class="genre-results-header">
      <span class="genre-results-icon">ğŸ¬</span>
      <span>Your Pitches</span>
    </div>
    <div id="genre-results-body" class="genre-results-body"></div>
  </section>

  <!-- â•â•â•â•â•â•â• Final Pitch Deck â•â•â•â•â•â•â• -->
  <section id="pitch-deck" class="hidden">
    <div class="pitch-deck-header">
      <h2>ğŸ“‹ Master Pitch Deck <span id="deck-version-badge" class="deck-version-badge"></span></h2>
      <div id="gatekeeper-badges" class="gatekeeper-badges hidden">
        <span id="gatekeeper-score-badge" class="gatekeeper-badge gatekeeper-score"></span>
        <span id="gatekeeper-platform-badge" class="gatekeeper-badge gatekeeper-platform"></span>
      </div>
      <p id="deck-verdict-text">Evaluatingâ€¦</p>
      <div class="deck-actions">
        <button id="btn-copy-deck" class="deck-action-btn" title="Copy to clipboard">ğŸ“‹ Copy</button>
        <button id="btn-export-docx" class="deck-action-btn" title="Export as DOCX">ğŸ“„ Export DOCX</button>
      </div>
    </div>
    <div id="pitch-deck-content" class="pitch-deck-content"></div>

    <!-- â•â•â•â•â•â•â• Refinement Chat â•â•â•â•â•â•â• -->
    <div id="qa-chat" class="qa-chat">
      <div class="qa-chat-header">
        <span class="qa-chat-icon">ğŸ”§</span>
        <span>Refine this pitch deck</span>
        <span id="revision-badge" class="revision-badge hidden">v1</span>
        <button id="btn-chat-help" class="chat-help-btn" title="Show commands">/help</button>
      </div>
      <div id="qa-messages" class="qa-messages"></div>
      <form id="qa-form" class="qa-form">
        <textarea id="qa-input" class="qa-input" placeholder="Ask, edit, or type /help for commandsâ€¦" rows="1"
          autocomplete="off"></textarea>
        <button type="submit" class="qa-send" id="qa-send">â†’</button>
      </form>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â• Quality Scorecard (inline, after pitch deck) â•â•â•â•â•â•â• -->
  <section id="scorecard" class="scorecard-section hidden">
    <div class="scorecard-header">
      <h3>ğŸ¯ Quality Scorecard</h3>
      <span id="scorecard-overall" class="scorecard-overall"></span>
    </div>
    <div id="scorecard-dims" class="scorecard-dims"></div>
    <div id="scorecard-recs" class="scorecard-recs"></div>
  </section>

  <!-- â•â•â•â•â•â•â• Advanced Settings Panel â•â•â•â•â•â•â• -->
  <aside id="advanced-panel" class="side-panel hidden">
    <div class="panel-header">
      <h3>âš™ï¸ Advanced Settings</h3>
      <button class="panel-close" data-close="advanced-panel">âœ•</button>
    </div>
    <div class="panel-body" style="padding: 1.5rem;">

      <!-- Iteration Control -->
      <div class="advanced-section">
        <h4 class="advanced-section-title">ğŸ”„ Revision Iterations</h4>
        <p class="advanced-section-desc">How many revision rounds the Quality Gate and Gatekeeper loops run.</p>
        <select id="max-iterations" class="advanced-select">
          <option value="0">0 â€” Single pass</option>
          <option value="1">1 â€” Light polish</option>
          <option value="2">2 â€” Standard</option>
          <option value="3" selected>3 â€” Default</option>
          <option value="4">4 â€” Deep refinement</option>
          <option value="5">5 â€” Maximum polish</option>
        </select>
      </div>

      <hr class="advanced-divider">

      <!-- Dryrun Benchmark -->
      <div class="advanced-section">
        <h4 class="advanced-section-title">ğŸ§ª Dryrun Benchmark</h4>
        <p class="advanced-section-desc">
          Runs 5 diverse test seeds + 1 calibration seed through the full pipeline, evaluates each output across 8
          quality dimensions, and surfaces aggregate scores + optimization recommendations.
        </p>
        <div id="dryrun-start-area">
          <button id="dryrun-start" class="btn-primary btn-launch">
            <span class="btn-text">Start Benchmark</span>
            <span class="btn-icon">â†’</span>
          </button>
        </div>
        <div id="dryrun-progress" class="dryrun-progress hidden">
          <div class="progress-bar">
            <div id="dryrun-progress-fill" class="progress-fill"></div>
          </div>
          <span id="dryrun-progress-text" class="progress-text">Startingâ€¦</span>
        </div>
        <div id="dryrun-results" class="dryrun-results hidden"></div>
        <div id="dryrun-history"></div>
      </div>

    </div>
  </aside>

  <!-- â•â•â•â•â•â•â• Prompt Editor Modal â•â•â•â•â•â•â• -->
  <div id="prompt-editor-overlay" class="prompt-editor-overlay hidden">
    <div class="prompt-editor-modal">
      <div class="prompt-editor-header">
        <div class="prompt-editor-agent-info">
          <span id="prompt-editor-icon" class="prompt-editor-icon"></span>
          <span id="prompt-editor-name" class="prompt-editor-name"></span>
        </div>
        <button id="prompt-editor-close" class="panel-close">âœ•</button>
      </div>
      <div class="prompt-editor-body">
        <textarea id="prompt-editor-textarea" class="prompt-editor-textarea" spellcheck="false"></textarea>
      </div>
      <div class="prompt-editor-footer">
        <span id="prompt-editor-status" class="prompt-editor-status"></span>
        <div class="prompt-editor-actions">
          <button id="prompt-editor-cancel" class="prompt-editor-btn prompt-editor-btn-cancel">Cancel</button>
          <button id="prompt-editor-save" class="prompt-editor-btn prompt-editor-btn-save">Save Prompt</button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• Error Toast â•â•â•â•â•â•â• -->
  <div id="error-toast" class="error-toast hidden">
    <span id="error-message"></span>
    <button id="error-dismiss" class="error-dismiss">âœ•</button>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>

</html>