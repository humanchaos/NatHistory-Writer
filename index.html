<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Script Writer â€” Wildlife Scriptment Engine</title>
  <meta name="description"
    content="A multi-agent AI system for developing blue-chip natural history film scriptments." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
    rel="stylesheet" />
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ¬</text></svg>" />
  <link rel="stylesheet" href="/src/styles.css" />
</head>

<body>

  <!-- â•â•â•â•â•â•â• Top Nav Bar â•â•â•â•â•â•â• -->
  <nav id="top-nav" class="top-nav">
    <div class="nav-brand">ğŸ¬ <span>ScriptWriter</span></div>
    <div class="nav-actions">
      <button id="btn-dryrun" class="nav-btn" title="Dryrun Benchmark">
        ğŸ§ª <span class="nav-btn-label">Dryrun</span>
      </button>
      <button id="btn-knowledge" class="nav-btn" title="Knowledge Base">
        ğŸ“š <span class="nav-btn-label">Knowledge</span>
        <span id="kb-badge" class="nav-badge hidden">0</span>
      </button>
      <button id="btn-history" class="nav-btn" title="Run History">
        ğŸ•“ <span class="nav-btn-label">History</span>
        <span id="history-badge" class="nav-badge hidden">0</span>
      </button>
    </div>
  </nav>

  <!-- â•â•â•â•â•â•â• Knowledge Panel (Right Slide) â•â•â•â•â•â•â• -->
  <aside id="knowledge-panel" class="side-panel hidden">
    <div class="panel-header">
      <h3>ğŸ“š Knowledge Base</h3>
      <button class="panel-close" data-close="knowledge-panel">âœ•</button>
    </div>
    <div class="panel-body">
      <p class="panel-description">Upload research papers, market briefs, or scripts (.txt, .md). Agents will reference
        this knowledge via RAG.</p>
      <div id="upload-zone" class="upload-zone">
        <input type="file" id="file-input" accept=".txt,.md,.text,.markdown" multiple hidden />
        <div class="upload-zone-content">
          <span class="upload-icon">â¬†</span>
          <span>Drop files here or <button id="browse-btn" class="link-btn">browse</button></span>
        </div>
      </div>
      <div id="upload-progress" class="upload-progress hidden">
        <div class="progress-bar">
          <div id="progress-fill" class="progress-fill"></div>
        </div>
        <span id="progress-text" class="progress-text">Embedding...</span>
      </div>
      <div id="doc-list" class="doc-list"></div>
    </div>
  </aside>

  <!-- â•â•â•â•â•â•â• History Panel (Right Slide) â•â•â•â•â•â•â• -->
  <aside id="history-panel" class="side-panel hidden">
    <div class="panel-header">
      <h3>ğŸ•“ Run History</h3>
      <button class="panel-close" data-close="history-panel">âœ•</button>
    </div>
    <div class="panel-body">
      <div id="history-list" class="history-list"></div>
      <p id="history-empty" class="panel-empty">No runs yet. Launch a simulation to see results here.</p>
    </div>
  </aside>

  <!-- â•â•â•â•â•â•â• Panel Overlay â•â•â•â•â•â•â• -->
  <div id="panel-overlay" class="panel-overlay hidden"></div>

  <!-- â•â•â•â•â•â•â• Hero Section â•â•â•â•â•â•â• -->
  <header id="hero">
    <div class="hero-bg"></div>
    <div class="hero-content">
      <div class="hero-badge">Multi-Agent AI System</div>
      <h1><span class="title-accent">Script</span>Writer</h1>
      <p class="hero-subtitle">Blue-Chip Wildlife Scriptment Engine</p>
      <p class="hero-description">
        Enter a seed idea or paste an existing script. Seven AI agents â€” an Analyst, Scientist,
        Field Producer, Story Producer, a ruthless Commissioning Editor, a Showrunner, and
        a cynical Gatekeeper â€” will debate, reject, revise, and ultimately greenlight your wildlife film pitch.
      </p>

      <!-- Mode Toggle -->
      <div class="mode-toggle">
        <button class="mode-tab active" data-mode="seed">ğŸŒ± Seed Idea</button>
        <button class="mode-tab" data-mode="script">ğŸ“ Assess Script</button>
      </div>

      <form id="seed-form">
        <div class="input-group">
          <textarea id="seed-input"
            placeholder="One idea per line â€” each runs the full pipeline&#10;e.g., A sequence about survival in the deep ocean abyssâ€¦&#10;Arctic fox migration patterns in a warming world"
            rows="4" required></textarea>
          <div class="optional-params">
            <div class="param-field">
              <label for="target-platform">ğŸ“º Platform <span class="param-hint">(optional)</span></label>
              <select id="target-platform">
                <option value="">Auto-detect best fit</option>
                <option value="Netflix">Netflix</option>
                <option value="Apple TV+">Apple TV+</option>
                <option value="BBC Studios">BBC Studios</option>
                <option value="Disney+">Disney+ / National Geographic</option>
                <option value="Amazon Prime">Amazon Prime</option>
                <option value="ZDF / ARTE">ZDF / ARTE</option>
                <option value="Channel 4">Channel 4</option>
                <option value="Smithsonian Channel">Smithsonian Channel</option>
                <option value="PBS">PBS</option>
              </select>
            </div>
            <div class="param-field">
              <label for="production-year">ğŸ“… Delivery Year <span class="param-hint">(optional)</span></label>
              <input type="number" id="production-year" min="2020" max="2035" placeholder="e.g., 2028">
            </div>
          </div>
          <button type="submit" class="btn-primary btn-launch" id="launch-btn">
            <span class="btn-text">Launch Simulation</span>
            <span class="btn-icon">â†’</span>
          </button>
        </div>
      </form>

      <div class="agent-roster">
        <div class="agent-chip" style="--agent-color: #00d4aa" data-agent-id="market-analyst">ğŸ“Š Analyst</div>
        <div class="agent-chip" style="--agent-color: #4dabf7" data-agent-id="chief-scientist">ğŸ”¬ Scientist</div>
        <div class="agent-chip" style="--agent-color: #ffa94d" data-agent-id="field-producer">ğŸ¥ Field Producer</div>
        <div class="agent-chip" style="--agent-color: #da77f2" data-agent-id="story-producer">âœï¸ Story Producer</div>
        <div class="agent-chip" style="--agent-color: #ff6b6b" data-agent-id="commissioning-editor">âš”ï¸ Commissioning
          Editor</div>
        <div class="agent-chip" style="--agent-color: #ffd43b" data-agent-id="showrunner">ğŸ¬ Showrunner</div>
        <div class="agent-chip" style="--agent-color: #e03131" data-agent-id="adversary">ğŸ›¡ï¸ Gatekeeper</div>
      </div>
    </div>
  </header>

  <!-- â•â•â•â•â•â•â• Simulation Viewport â•â•â•â•â•â•â• -->
  <main id="simulation" class="hidden">
    <div class="simulation-header">
      <h2>Mission Control</h2>
      <div id="phase-indicator" class="phase-indicator">
        <span class="phase-dot" data-phase="1">1</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="2">2</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="3">3</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="4">4</span>
        <span class="phase-connector"></span>
        <span class="phase-dot" data-phase="5">5</span>
      </div>
    </div>
    <div id="timeline" class="timeline"></div>
  </main>

  <!-- â•â•â•â•â•â•â• Final Pitch Deck â•â•â•â•â•â•â• -->
  <section id="pitch-deck" class="hidden">
    <div class="pitch-deck-header">
      <h2>ğŸ“‹ Master Pitch Deck <span id="deck-version-badge" class="deck-version-badge"></span></h2>
      <div id="gatekeeper-badges" class="gatekeeper-badges hidden">
        <span id="gatekeeper-score-badge" class="gatekeeper-badge gatekeeper-score"></span>
        <span id="gatekeeper-platform-badge" class="gatekeeper-badge gatekeeper-platform"></span>
      </div>
      <p id="deck-verdict-text">Evaluatingâ€¦</p>
      <div class="deck-actions">
        <button id="btn-copy-deck" class="deck-action-btn" title="Copy to clipboard">ğŸ“‹ Copy</button>
        <button id="btn-export-docx" class="deck-action-btn" title="Export as DOCX">ğŸ“„ Export DOCX</button>
      </div>
    </div>
    <div id="pitch-deck-content" class="pitch-deck-content"></div>

    <!-- â•â•â•â•â•â•â• Refinement Chat â•â•â•â•â•â•â• -->
    <div id="qa-chat" class="qa-chat">
      <div class="qa-chat-header">
        <span class="qa-chat-icon">ğŸ”§</span>
        <span>Refine this pitch deck</span>
        <span id="revision-badge" class="revision-badge hidden">v1</span>
        <button id="btn-chat-help" class="chat-help-btn" title="Show commands">/help</button>
      </div>
      <div id="qa-messages" class="qa-messages"></div>
      <form id="qa-form" class="qa-form">
        <textarea id="qa-input" class="qa-input" placeholder="Ask, edit, or type /help for commandsâ€¦" rows="1"
          autocomplete="off"></textarea>
        <button type="submit" class="qa-send" id="qa-send">â†’</button>
      </form>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â• Quality Scorecard (inline, after pitch deck) â•â•â•â•â•â•â• -->
  <section id="scorecard" class="scorecard-section hidden">
    <div class="scorecard-header">
      <h3>ğŸ¯ Quality Scorecard</h3>
      <span id="scorecard-overall" class="scorecard-overall"></span>
    </div>
    <div id="scorecard-dims" class="scorecard-dims"></div>
    <div id="scorecard-recs" class="scorecard-recs"></div>
  </section>

  <!-- â•â•â•â•â•â•â• Dryrun Report Modal â•â•â•â•â•â•â• -->
  <div id="dryrun-overlay" class="dryrun-overlay hidden">
    <div class="dryrun-modal">
      <div class="dryrun-modal-header">
        <h3>ğŸ§ª Dryrun Benchmark</h3>
        <button id="dryrun-close" class="panel-close">âœ•</button>
      </div>
      <div class="dryrun-modal-body">
        <p class="panel-description">
          Runs 3 diverse test seeds through the full pipeline, evaluates each output across 6 quality dimensions,
          and surfaces aggregate scores + optimization recommendations.
        </p>
        <div id="dryrun-start-area">
          <button id="dryrun-start" class="btn-primary btn-launch">
            <span class="btn-text">Start Benchmark</span>
            <span class="btn-icon">â†’</span>
          </button>
        </div>
        <div id="dryrun-progress" class="dryrun-progress hidden">
          <div class="progress-bar">
            <div id="dryrun-progress-fill" class="progress-fill"></div>
          </div>
          <span id="dryrun-progress-text" class="progress-text">Startingâ€¦</span>
        </div>
        <div id="dryrun-results" class="dryrun-results hidden"></div>
        <div id="dryrun-history"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• Prompt Editor Modal â•â•â•â•â•â•â• -->
  <div id="prompt-editor-overlay" class="prompt-editor-overlay hidden">
    <div class="prompt-editor-modal">
      <div class="prompt-editor-header">
        <div class="prompt-editor-agent-info">
          <span id="prompt-editor-icon" class="prompt-editor-icon"></span>
          <span id="prompt-editor-name" class="prompt-editor-name"></span>
        </div>
        <button id="prompt-editor-close" class="panel-close">âœ•</button>
      </div>
      <div class="prompt-editor-body">
        <textarea id="prompt-editor-textarea" class="prompt-editor-textarea" spellcheck="false"></textarea>
      </div>
      <div class="prompt-editor-footer">
        <span id="prompt-editor-status" class="prompt-editor-status"></span>
        <div class="prompt-editor-actions">
          <button id="prompt-editor-cancel" class="prompt-editor-btn prompt-editor-btn-cancel">Cancel</button>
          <button id="prompt-editor-save" class="prompt-editor-btn prompt-editor-btn-save">Save Prompt</button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• Error Toast â•â•â•â•â•â•â• -->
  <div id="error-toast" class="error-toast hidden">
    <span id="error-message"></span>
    <button id="error-dismiss" class="error-dismiss">âœ•</button>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>

</html>